mtcars.pca <- prcomp(mtcars[,c(1:7,10,11)], center = TRUE,scale. = TRUE)
mtcars.pca
mtcars.pca
summary(mtcars.pcs)
summary(mtcars.pca)
summary(mtcars.pca)
str(mtcars.pca)
install.packages("ggbiplot")
library(devtools)
install_github("vqv/ggbiplot")
library(devtools)
library("devtools")
install.packages("devtools")
clear
cls
library("devtools")
library(devtools)
install_github("vqv/ggbiplot")
library(ggbiplot)
ggbiplot(mtcars.pca)
ggbiplot(mtcars.pca, labels=rownames(mtcars))
ggbiplot(mtcars.pca,ellipse=TRUE,obs.scale = 1, var.scale = 1,  labels=rownames(mtcars), groups=mtcars.country) +
scale_colour_manual(name="Origin", values= c("forest green", "red3", "dark blue"))+
ggtitle("PCA of mtcars dataset")+
theme_minimal()+
theme(legend.position = "bottom")
mtcars.country <- c(rep("Japan", 3), rep("US",4), rep("Europe", 7),rep("US",3), "Europe", rep("Japan", 3), rep("US",4), rep("Europe", 3), "US", rep("Europe", 3))
ggbiplot(mtcars.pca,ellipse=TRUE,obs.scale = 1, var.scale = 1,  labels=rownames(mtcars), groups=mtcars.country) +
scale_colour_manual(name="Origin", values= c("forest green", "red3", "dark blue"))+
ggtitle("PCA of mtcars dataset")+
theme_minimal()+
theme(legend.position = "bottom")
mtcars
install.packages("popr")
install.packages("poppr")
library('poppr')
data(partical_clone)
data(partial_clone)
partial_clone
as.data.frame(partial_clone)
amova
data(woodmouse)
requure(ape)
require(ape)
data(woodmoue)
data(woodmouse)
woodmouse
library(adegenet)
df <- data.frame(locusA=c("11","11","12","32"),
locusB=c(NA,"34","55","15"),locusC=c("22","22","21","22"))
row.names(df) <- .genlab("genotype",4)
df
install.packages("adegenet")
clear
library('ade4get')
library('adegenet')
row.names(df) <- .genlab("genotype",4)
df
obj <- df3genind(df, ploidy=2, ncode=1)
obj <- df2genind(df, ploidy=2, ncode=1)
obj
tab(obj)
obj <- df2genind(df, ploidy=1, ncode=1)
tab(obj)
pippr.amova(obj)
poppr.amova(obj)
library('poppr')
poppr.amova(obj)
poppr.amova(obj, hier=NULL)
poppr.amova(obj, ~Pop/Subpop)
df <- data.frame(locusA=c("11","11","12","32"),
locusB=c("11","34","55","15"),locusC=c("22","22","21","22"))
row.names(df) <- .genlab("genotype",4)
df
obj <- df2genind(df, ploidy=2, ncode=1)
poppr.amova(obj)
tab(obj)
poppr.amova(obj, ~Pop/Subpop)
df <- data.frame(locusA=c("11","11","12"),
locusB=c("11","34","55",),locusC=c("22","22","21","22"))
row.names(df) <- .genlab("genotype",4)
df
df <- data.frame(locusA=c("11","11","12"),
locusB=c("11","34","55"),locusC=c("22","21","22"))
row.names(df) <- .genlab("genotype",4)
df
df <- data.frame(locusA=c("11","11","12"),
locusB=c("11","34","55"),locusC=c("22","21","22"))
row.names(df) <- .genlab("genotype",3)
df
obj <- df2genind(df, ploidy=2, ncode=1)
tab(obj)
poppr.amova(obj, ~Pop/Subpop)
install.packages('haplotypes')
library('haplotypes')
data("dna.obj")
### Method for signature 'Dna'.
x<-dna.obj
x<-dna.obj[c(1,20,21,26,27,28,30,3,4,7,13,14,15,16,23,24,25),,as.matrix=FALSE]
populations<-c("pop1","pop1","pop1","pop1","pop1","pop1","pop1","pop2",
"pop2","pop2","pop2","pop2","pop3","pop4","pop3","pop4","pop4")
##skip permutation testing
pst<-pairPhiST(x, populations, nperm=0)
pst
##allow negative PhiST values
pst<-pairPhiST(x, populations, nperm=0, negatives=TRUE)
pst
##Gaps as missing characters.
pst<-pairPhiST(x, populations, indels="m", nperm=0, negatives=TRUE)
pst
##using subset, second population against others
pst <-pairPhiST(x, populations, nperm=0,subset=c(2))
pst
## Not run:
## 999 permutations.
pst<-pairPhiST(x, populations, nperm=999,showprogbar=TRUE)
pst
## random populations
x<-dna.obj
populations<-sample(1:4,nrow(x),replace=TRUE)
pst<-pairPhiST(x, populations, nperm=999,showprogbar=TRUE)
pst
## populations based on clusters
x<-dna.obj
d<-distance(x)
hc<-hclust(d,method="ward.D")
populations<-cutree(hc,4)
pst<-pairPhiST(x, populations, nperm=999,showprogbar=TRUE)
pst
## End(Not run)
### Method for signature 'dist'.
x<-dna.obj
x<-dna.obj[c(1,20,21,26,27,28,30,3,4,7,13,14,15,16,23,24,25),,as.matrix=FALSE]
populations<-c("pop1","pop1","pop1","pop1","pop1","pop1","pop1","pop2",
"pop2","pop2","pop2","pop2","pop3","pop4","pop3","pop4","pop4")
d<-distance(x)
pst<-pairPhiST(d, populations, nperm=0)
pst
### Method for signature 'matrix'.
x<-dna.obj
x<-dna.obj[c(1,20,21,26,27,28,30,3,4,7,13,14,15,16,23,24,25),,as.matrix=FALSE]
populations<-c("pop1","pop1","pop1","pop1","pop1","pop1","pop1","pop2",
"pop2","pop2","pop2","pop2","pop3","pop4","pop3","pop4","pop4")
d<-as.matrix(distance(x))
pst<-pairPhiST(d, populations, nperm=0)
pst
data("dna.obj")
### Method for signature 'Dna'.
x<-dna.obj
x<-dna.obj[c(1,20,21,26,27,28,30,3,4,7,13,14,15,16,23,24,25),,as.matrix=FALSE]
populations<-c("pop1","pop1","pop1","pop1","pop1","pop1","pop1","pop2",
"pop2","pop2","pop2","pop2","pop3","pop4","pop3","pop4","pop4")
##skip permutation testing
pst<-pairPhiST(x, populations, nperm=0)
pst
library('haplotypes')
data("dna.obj")
### Method for signature 'Dna'.
x<-dna.obj
x<-dna.obj[c(1,20,21,26,27,28,30,3,4,7,13,14,15,16,23,24,25),,as.matrix=FALSE]
populations<-c("pop1","pop1","pop1","pop1","pop1","pop1","pop1","pop2",
"pop2","pop2","pop2","pop2","pop3","pop4","pop3","pop4","pop4")
##skip permutation testing
pst<-pairPhiST(x, populations, nperm=0)
pst
dna.obj
x
x<-dna.obj[c(1,20,21,26,27,28,30,3,4,7,13,14,15,16,23,24,25),,as.matrix=TRUE]
x
write.csv(x, "./Downloads/dna.csv")
write.csv(populations, "./Downloads/populations.csv")
library('textshape')
library('ade4')
setwd('~/Documents/Work/sfc-journal-2020/')
# subset samples
indianCanto <- list("samples", "distances", "structures")
df <- read.csv('./data/samples.csv')
indianCanto$samples = subset(df, select = -c(X))
indianCanto$samples <- column_to_rownames(indianCanto$samples, "canto_coding_id")
df <- read.csv('./data/filtered.csv')
df <- subset(df, select = -c(X, Number.of.Samples, region, division, subregion, area_kingdom, culture, lat, lng))
df <- column_to_rownames(df, "canto_coding_id")
indianCanto$distances <- dist(df, method="euclidean")
df <- read.csv('./data/structure.csv')
df = subset(df, select=-c(X))
factors <- df[['language']]
indianCanto$structures <- data.frame(region = as.factor(factors))
indianCanto$amova <- amova(indianCanto$samples, quasieuclid(indianCanto$distances), indianCanto$structures)
indianCanto$amova
